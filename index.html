<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Valuefulness — 7×7 Program</title>
<meta name="description" content="Seven chapters. Seven days each. Quote → exercise with progressive overload."/>
<style>
  :root{
    --bg:#0b1210; --ink:#eaf7f1; --muted:#a8c3b9; --card:#0f1814; --line:rgba(255,255,255,.08);
    --accent:#29d66f; --accent2:#129a58; --r:18px; --sh:0 14px 34px rgba(0,0,0,.35)
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,Arial;color:var(--ink);
    background:radial-gradient(1000px 700px at 80% -10%, #163a2b 0%, #0b1512 40%, #0b1210 70%) , #0b1210}
  .wrap{max-width:980px;margin:0 auto;padding:20px}
  .row{display:flex;align-items:center;gap:10px;flex-wrap:wrap}
  .card{background:linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,0)), var(--card);
    border:1px solid var(--line);border-radius:var(--r);box-shadow:var(--sh);padding:14px}
  .btn{border:1px solid var(--line);background:#0e1814;color:var(--ink);border-radius:12px;padding:9px 12px;cursor:pointer}
  .primary{background:linear-gradient(160deg,var(--accent),var(--accent2));color:#06371f;border:none;font-weight:700}
  h1{font-size:20px;margin:0}
  .muted{color:var(--muted);font-size:13px}
  .grid{display:grid;grid-template-columns:1.2fr 1fr;gap:14px}
  @media (max-width:900px){.grid{grid-template-columns:1fr}}
  .pill{background:#0b1512;border:1px solid var(--line);border-radius:999px;padding:8px 12px;font-size:12px;color:var(--muted)}
  .big{display:grid;place-items:center;padding:18px;border-radius:24px;background:linear-gradient(160deg,#0f1f1a,#0b1512);border:1px solid var(--line)}
  .cta{width:220px;height:220px;border:none;border-radius:50%;font-weight:800;font-size:18px;letter-spacing:.2px;cursor:pointer;
    background: radial-gradient(85% 85% at 50% 20%, #4affb4, var(--accent) 55%, var(--accent2) 100%);
    box-shadow: inset 0 -8px 16px rgba(0,0,0,.18), 0 30px 60px rgba(18,166,90,.35)}
  .list{display:flex;flex-direction:column;gap:8px;max-height:420px;overflow:auto}
  .item{display:grid;grid-template-columns:60px 1fr 80px;gap:8px;align-items:center;padding:10px;background:#0b1512;border:1px solid var(--line);border-radius:12px}
  #map{display:grid;grid-template-columns:repeat(7,1fr);gap:6px}
  .node{background:#0b1512;border:1px solid var(--line);border-radius:12px;padding:8px;text-align:center;font-size:12px}
  .node.lock{opacity:.45;filter:grayscale(.3)}
  /* modal */
  .modal{position:fixed;inset:0;display:none;place-items:center;background:rgba(0,0,0,.55);padding:18px}
  .modal.open{display:grid}
  .sheet{width:min(720px,96vw);background:var(--card);border:1px solid var(--line);border-radius:18px;box-shadow:var(--sh);padding:16px}
  blockquote{margin:0;padding:10px 12px;border-left:3px solid var(--accent);background:#0a1411;border-radius:8px}
  textarea{width:100%;background:#0a1411;border:1px solid var(--line);color:var(--ink);padding:12px 14px;border-radius:12px;font-size:15px}
</style>
</head>
<body>
  <div class="wrap">
    <header class="row" style="justify-content:space-between">
      <div class="row">
        <div style="width:40px;height:40px;border-radius:50%;background:conic-gradient(from 270deg,var(--accent),#71f7b7,var(--accent2) 65%,#0d7c48 85%,var(--accent))"></div>
        <div>
          <h1>Valuefulness</h1>
          <div class="muted">Seven chapters. Seven days each. Quote → exercise with overload.</div>
        </div>
      </div>
      <div class="row">
        <button class="btn" id="exportBtn">Export</button>
        <label class="btn" for="importFile">Import<input id="importFile" type="file" accept="application/json" hidden></label>
        <button class="btn" id="resetBtn">Reset</button>
      </div>
    </header>

    <div class="grid">
      <section class="card">
        <div class="row" style="justify-content:space-between">
          <div>
            <div class="muted">Next session</div>
            <div id="lessonTitle" style="font-weight:700">—</div>
            <div class="muted" id="chapterTheme">—</div>
          </div>
          <div class="row">
            <div class="pill" id="stepPill">Day 1/7</div>
            <div class="pill" id="chapPill">Chapter 1/7</div>
          </div>
        </div>
        <div class="big" style="margin-top:8px">
          <button class="cta" id="start">Start</button>
        </div>
        <div style="height:10px"></div>
        <div class="card" style="padding:10px">
          <div class="muted">Map</div>
          <div id="map"></div>
        </div>
      </section>

      <aside class="card">
        <div class="row" style="justify-content:space-between">
          <div style="font-weight:700">History</div>
          <div class="muted">Newest first</div>
        </div>
        <div class="list" id="history"></div>
      </aside>
    </div>
  </div>

  <!-- Modal: session -->
  <div class="modal" id="modal">
    <div class="sheet">
      <div class="row" style="justify-content:space-between">
        <div id="stageTitle" style="font-weight:700">Session</div>
        <button class="btn" id="close">✕</button>
      </div>

      <div id="quoteWrap" style="margin-top:8px">
        <div class="muted">Chapter quote</div>
        <blockquote id="quote">“Replace with Mazzone quote for this chapter and keep it short.”</blockquote>
      </div>

      <div id="exerciseWrap" style="margin-top:12px;display:none">
        <div style="font-weight:700" id="exerciseTitle">Exercise</div>
        <div class="muted" id="exerciseBase">—</div>
        <div class="muted" id="overload" style="margin-top:6px;color:#c7e9d6">—</div>
        <div style="height:8px"></div>
        <textarea id="answer" rows="5" placeholder="Write here…"></textarea>
        <div class="row" style="justify-content:flex-end;margin-top:8px">
          <button class="btn primary" id="save">Save</button>
        </div>
      </div>

      <div class="row" style="justify-content:flex-end;margin-top:8px">
        <button class="btn" id="next">Next</button>
      </div>
    </div>
  </div>

<script>
/* =================== Program spec =================== */
/* Quotes are placeholders. Replace QUOTES[x] strings with your real short quotes. */
const QUOTES = [
  "Method — placeholder quote.",
  "Value — placeholder quote.",
  "Mythology — placeholder quote.",
  "Ethics — placeholder quote.",
  "Meaning — placeholder quote.",
  "Mind — placeholder quote.",
  "Cognition — placeholder quote."
];

const PROGRAM = [
  { name:"Method", theme:"Philosophy as disciplined self-inquiry.",
    base:"Observe the mechanism of choosing and valuing.",
    overload:[
      "Day 1 — Describe one recent choice.",
      "Day 2 — Describe how you decided.",
      "Day 3 — Identify the value that guided it.",
      "Day 4 — Name one unchosen option and its cost.",
      "Day 5 — Find a pattern across the last three entries.",
      "Day 6 — Condense your method of valuing in ≤ 12 words.",
      "Day 7 — Act today using that personal method once."
    ]},
  { name:"Value", theme:"Value is selection, not possession.",
    base:"Extract “value-kernels” from experience.",
    overload:[
      "Day 1 — One moment that felt valuable.",
      "Day 2 — Why was it valuable?",
      "Day 3 — What quality mattered most?",
      "Day 4 — Phrase that quality in 6 words.",
      "Day 5 — Another moment with the same quality.",
      "Day 6 — Can the quality exist without the object?",
      "Day 7 — Create that quality deliberately today."
    ]},
  { name:"Mythology", theme:"Roles and stories distort value.",
    base:"Separate value from identity roles.",
    overload:[
      "Day 1 — List main social roles.",
      "Day 2 — Pick one; what value do you chase through it?",
      "Day 3 — Express that value outside the role.",
      "Day 4 — Perform such an act once.",
      "Day 5 — Describe the feeling of separation from the role.",
      "Day 6 — Shorten your list; keep only value labels.",
      "Day 7 — Live one day without invoking the role mentally."
    ]},
  { name:"Ethics", theme:"Live values, not rules.",
    base:"Replace judgment with enacted value.",
    overload:[
      "Day 1 — Recall one moral judgment you made.",
      "Day 2 — Identify its underlying value.",
      "Day 3 — Act on that value without judging.",
      "Day 4 — Notice resistance or pride.",
      "Day 5 — One sentence linking humility to value.",
      "Day 6 — Apply to another small judgment.",
      "Day 7 — Summarize your ethical pattern in 10 words."
    ]},
  { name:"Meaning", theme:"Meaning = value that survives loss.",
    base:"Practice equanimity under absence.",
    overload:[
      "Day 1 — Name a current loss.",
      "Day 2 — Name what value remains possible now.",
      "Day 3 — Do a small act serving it.",
      "Day 4 — Reflect on felt sufficiency.",
      "Day 5 — Imagine another future loss; repeat the pattern.",
      "Day 6 — Condense the pattern into one sentence.",
      "Day 7 — Use that sentence as a mantra today."
    ]},
  { name:"Mind", theme:"Attention is the medium of value.",
    base:"Rest awareness on value quality, not object.",
    overload:[
      "Day 1 — 30 s silent focus on bodily sensation.",
      "Day 2 — Name the quality felt.",
      "Day 3 — Hold attention on the quality, not location.",
      "Day 4 — Repeat 60 s twice today.",
      "Day 5 — Describe how stability changes perception.",
      "Day 6 — Extend to 90 s; note drift count.",
      "Day 7 — Define “valuing without object” in your words."
    ]},
  { name:"Cognition", theme:"Thinking should serve valuing.",
    base:"Compress understanding; express clearly.",
    overload:[
      "Day 1 — Write one sentence capturing your current insight.",
      "Day 2 — Delete half the words.",
      "Day 3 — Speak it aloud; refine phrasing.",
      "Day 4 — Explain it to a skeptic.",
      "Day 5 — Make it universal: remove “I”.",
      "Day 6 — Turn it into a guiding maxim.",
      "Day 7 — Enact one decision by that maxim."
    ]}
];

/* =================== State =================== */
const LS_KEY = "pov_7x7_v1";
function load(){
  try{ return JSON.parse(localStorage.getItem(LS_KEY)) || {
    chapter:0, day:0, // 0..6; 0..6
    entries:[],        // {date, chapter, day, note}
    lastDone:null
  }; }catch(e){ return {chapter:0, day:0, entries:[], lastDone:null}; }
}
const S = load();
function save(){ localStorage.setItem(LS_KEY, JSON.stringify(S)); }
function todayStr(){
  const d=new Date(); const z=d.getTimezoneOffset();
  return new Date(d.getTime()-z*60000).toISOString().slice(0,10);
}

/* =================== UI refs =================== */
const $=s=>document.querySelector(s), $$=s=>Array.from(document.querySelectorAll(s));
const lessonTitle=$('#lessonTitle'), chapterTheme=$('#chapterTheme'), stepPill=$('#stepPill'), chapPill=$('#chapPill');
const start=$('#start'), map=$('#map'), historyEl=$('#history');
const modal=$('#modal'), closeBtn=$('#close'), nextBtn=$('#next');
const quoteWrap=$('#quoteWrap'), quoteEl=$('#quote');
const exerciseWrap=$('#exerciseWrap'), exTitle=$('#exerciseTitle'), exBase=$('#exerciseBase'), exOver=$('#overload'), answer=$('#answer');
const exportBtn=$('#exportBtn'), importFile=$('#importFile'), resetBtn=$('#resetBtn');

/* =================== Render =================== */
function render(){
  const ch=PROGRAM[S.chapter]; const day=S.day+1;
  lessonTitle.textContent = `${ch.name} — Day ${day}`;
  chapterTheme.textContent = ch.theme;
  stepPill.textContent = `Day ${day}/7`;
  chapPill.textContent = `Chapter ${S.chapter+1}/7`;
  renderMap();
  renderHistory();
}
function renderMap(){
  map.innerHTML="";
  PROGRAM.forEach((c,i)=>{
    const n=document.createElement('div');
    n.className='node'+(i>S.chapter?' lock':'');
    const status = i<S.chapter ? '✓' : (i===S.chapter? `Day ${S.day+1}/7` : 'Locked');
    n.textContent = `${i+1}. ${c.name} · ${status}`;
    map.appendChild(n);
  });
}
function renderHistory(){
  const arr=[...S.entries].sort((a,b)=> a.date<b.date?1:-1);
  historyEl.innerHTML = arr.map(e=>{
    const label = `${PROGRAM[e.chapter].name} · Day ${e.day+1}`;
    return `<div class="item">
      <div class="muted" style="text-align:center">${new Date(e.date+'T00:00:00').toLocaleDateString(undefined,{year:'numeric',month:'short',day:'numeric'})}</div>
      <div><div style="font-weight:700">${label}</div><div class="muted">${(e.note||'').replace(/[<>&]/g,s=>({'<':'&lt;','>':'&gt;','&':'&amp;'}[s]))||'(no note)'}</div></div>
      <div class="muted" style="text-align:right">#${e.chapter+1}.${e.day+1}</div>
    </div>`;
  }).join('');
}

/* =================== Session flow =================== */
let stage=0; // 0=quote, 1=exercise
start.onclick=()=> openSession();
nextBtn.onclick=()=> {
  if(stage===0){ // move to exercise
    stage=1;
    quoteWrap.style.display='none';
    exerciseWrap.style.display='block';
    nextBtn.style.display='none';
  } else { /* no-op */ }
};
closeBtn.onclick=()=> modal.classList.remove('open');

function openSession(){
  stage=0; answer.value="";
  const ch=PROGRAM[S.chapter];
  quoteEl.textContent = QUOTES[S.chapter];
  exTitle.textContent = "Exercise";
  exBase.textContent = ch.base;
  exOver.textContent = ch.overload[S.day];
  quoteWrap.style.display='block';
  exerciseWrap.style.display='none';
  nextBtn.style.display='inline-block';
  modal.classList.add('open');
}

/* Enforce one completion per calendar day. Remove if you want free-run. */
function canCompleteToday(){
  const t=todayStr();
  return S.lastDone!==t;
}

document.getElementById('save').onclick = ()=>{
  if(!canCompleteToday()){
    alert("Today's session already completed. Come back tomorrow.");
    return;
  }
  const entry = {date:todayStr(), chapter:S.chapter, day:S.day, note:answer.value.trim()};
  S.entries.push(entry);
  S.lastDone = todayStr();

  // advance progression
  if(S.day<6){ S.day++; }
  else { S.day=0; if(S.chapter<6) S.chapter++; }

  save();
  modal.classList.remove('open');
  render();
};

/* =================== Export / Import / Reset =================== */
exportBtn.onclick = ()=>{
  const blob=new Blob([JSON.stringify(S,null,2)],{type:'application/json'});
  const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='valuefulness-7x7.json'; a.click(); URL.revokeObjectURL(a.href);
};
importFile.onchange = async e=>{
  const f=e.target.files[0]; if(!f) return;
  try{ const obj=JSON.parse(await f.text());
    if(typeof obj.chapter!=='number' || typeof obj.day!=='number') throw new Error('invalid');
    Object.assign(S,obj); save(); render();
  }catch{ alert('Invalid file'); }
  e.target.value='';
};
resetBtn.onclick=()=>{
  if(!confirm('Delete all progress?')) return;
  localStorage.removeItem(LS_KEY); location.reload();
};

/* =================== Init =================== */
render();

/* Optional keyboard shortcuts */
document.addEventListener('keydown', e=>{
  if(['INPUT','TEXTAREA'].includes(document.activeElement.tagName)) return;
  if(e.key.toLowerCase()==='s') start.click();
});
</script>
</body>
</html>
